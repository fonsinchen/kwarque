<!DOCTYPE html>
<html>
    <head>
        <title>kwarque</title>
        <link rel="stylesheet" type="text/css" href="css/kwarque.css"/>
        <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.8.19.custom.css"/>

        <script src="js/openlayers.js" type="text/javascript"></script>
        <script src="js/socket.io.js" type="text/javascript"></script>
        <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
        <script src="js/jquery-ui-1.8.19.custom.min.js" type="text/javascript"></script>
        <script src="js/kwarque.js" type="text/javascript"></script>
        <script src="js/quadtree.js" type="text/javascript"></script>
        <script src="js/chat.js" type="text/javascript"></script>
        <script src="js/chatUi.js" type="text/javascript"></script>
        <script src="js/map.js" type="text/javascript"></script>

        <script type="text/javascript">
            (function ($) {
                $(document).ready(function() {
                    $("#map").kwarqueMap();
                    $('#map').kwarqueMap('connect');
                    $('.kwarque-chat').kwarqueChat();
                    $("#nick-space").submit(function (e) {
                        e.preventDefault();
                        var callback = function(result) {
                            if (result !== 'error') $("#nick-space").remove();
                        };
                        if ($('#login').val() === 'login') {
                            $('.kwarque-chat').kwarqueChat('login',
                                    $("#nick").val(), $("#password").val(),
                                    callback);
                        } else {
                            $('.kwarque-chat').kwarqueChat('register', 
                                    $("#nick").val(), $("#password").val(),
                                    $("#password-repeat").val(), callback);
                        }
                    });
                    $('#register').click(function () {
                        $(this).hide();
                        $('#password-repeat-space').show();
                        $('#login').val("register");
                    });
                });
            })(jQuery);
        </script>
    </head>

    <body>
        <div id="chat" class="kwarque-chat">
            <form id="nick-space" action="#">
                <div>
                    <input name="nick" type="text" class="login-field" id="nick"/>
                    <label for="nick">nick</label>
                </div>
                <div>
                    <input name="password" type="password" class="login-field" id="password"/>
                    <label for="password">password</label>
                </div>
                <div id="password-repeat-space">
                    <input name="password-repeat" type="password" class="login-field" id="password-repeat"/>
                    <label for="password-repeat">repeat</label>
                </div>
                <input type="submit" id="login" value="login"/>
                <input type="button" id="register" value="register"/>
            </form>
                    
            <form id="chat-input" class="kwarque-chat-input" action="#">
                <input type="submit" value="kwrq" tabindex="2" class="kwarque-chat-submit">
                <input name="text" value="" size="50" class="kwarque-chat-message" autocomplete="off">
            </form>
        </div>
        <div id="map" class="map">
            <div class="kwarque-map-popup">
                <p class="kwarque-map-popup-text"></p>
            </div>
            <div class="kwarque-map-input">
                <form action="#">
                    <input type="text" class="kwarque-map-input-lon"/>
                    <input type="text" class="kwarque-map-input-lat"/>
                    <input type="text" class="kwarque-map-input-title"/>
                    <textarea class="kwarque-map-input-text"></textarea>
                    <input type="submit" value="kwrq" class="kwarque-map-input-submit">
                </form>
            </div>
            
            <button class="kwarque-map-add">+</button>
        </div>
        <div id="templates">
            
        </div>
    </body>
</html>
