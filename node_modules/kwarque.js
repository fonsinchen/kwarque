"use strict";

/*!
 * This file is part of kwarque.
 * Copyright(c) 2012 Ulf Hermann <ulf_hermann@gmx.net>
 * Licensed under AGPL v3, see COPYING
 */

var express = require("express");
var app = express.createServer();

console.log(__dirname + "/../public/index.html");


app.configure(function () {
    app.set('view options', {layout: false});
    app.use(express.methodOverride());
    app.use(express.bodyParser());
    app.use(express["static"](__dirname + '/../public'));
    app.use(express.errorHandler({
        dumpExceptions: true,
        showStack: true
    }));
    app.use(app.router);
    app.register('.html', {
        compile: function(str) {
            return function() {return str;};
        }
    });
});

app.get("/", function (req, res) {
    res.render(__dirname + "/../public/index.html");
});

var create = function (obj) {
    var F = function() {};
    F.prototype = obj;
    return new F();
};

module.exports = create(require('events').EventEmitter.prototype);
module.exports.create = create;
module.exports.app = app;
module.exports.noop = function() {};


